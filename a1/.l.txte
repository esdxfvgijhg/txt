5g \cite{polese_m2m_2016}   \citet{polese_m2m_2016} stated that LoRa is a viable solution for the deployment of a Smart City and tested LoRa coverage based on one of modulation parameters and then proposed a LoRa system architecture based on the number in a particular urban population in Italy. Our proposed architecture considered practical network coverage and signal attenuation in various building density environments.~   \newline 
ytre\cite{bouzouita_random_2015}   hgtfrdes   \newline 
ytre\cite{agiwal_next_2016}    \newline 
ytre\cite{aijaz_hap-slicer_2018}    \newline 
ytre\cite{alqahtani_multi-stage_2019}    \newline 
ytre\cite{bouzouita_estimating_2018}    \newline 
ytre\cite{bouzouita_multiple_2015}    \newline 
ytre\cite{buyya_management_2019}    \newline 
ytre\cite{doro_toward_2019}    \newline 
ytre\cite{ferrus_5g_2018}    \newline 
ytre\cite{ferrus_management_nodate}    \newline 
ytre\cite{gadallah_dynamic_2017}    \newline 
ytre\cite{hao_network_2018}    \newline 
ytre\cite{kazmi_network_2019}    \newline 
ytre\cite{kliks_reinforcement_2019}    \newline 
ytre\cite{kotulski_end--end_2017}    \newline 
ytre\cite{nakao_end--end_2017}    \newline 
ytre\cite{ojaghi_sliced-ran_2019}    \newline 
ytre\cite{othman_efficient_2019}    \newline 
ytre\cite{perez-romero_profit-based_2019}    \newline 
ytre\cite{sama_service-based_2016}    \newline 
ytre\cite{sun_user_2019}    \newline 
ytre\cite{yan_intelligent_2019}    \newline 
ytre\cite{doro_slice_2019}   [object Object]   \newline 
5g-slice \cite{sciancalepore_storns_2019}   Comment: Submitted for publication to IEEE conference   \newline 
 \cite{benkacem_optimal_2018}    \newline 
 \cite{caballero_multi-tenant_2017}    \newline 
 \cite{chang_radio_2018}    \newline 
 \cite{coronado_flow-based_2019}    \newline 
 \cite{costanzo_network_2018}    \newline 
 \cite{dang_delay-aware_2018}    \newline 
 \cite{doro_low-complexity_2018}    \newline 
 \cite{foukas_flexran_2016}    \newline 
 \cite{gudipati_radiovisor_2014}    \newline 
 \cite{ha_end--end_2017}    \newline 
 \cite{hu_tri-level_2018}    \newline 
 \cite{kotulski_graph-based_2018}    \newline 
 \cite{koutlia_design_2019}    \newline 
 \cite{ksentini_toward_2017}    \newline 
 \cite{lee_dynamic_nodate}    \newline 
 \cite{luu_coverage-aware_2019}    \newline 
 \cite{nojima_ran_2019}    \newline 
 \cite{sallent_radio_2017}    \newline 
 \cite{shafigh_dynamic_2017}    \newline 
 \cite{soenen_demystifying_2017}    \newline 
 \cite{sui_energy-efficient_2019}    \newline 
 \cite{sun_distributed_2019}    \newline 
 \cite{sun_hierarchical_2019}    \newline 
 \cite{tang_delay-aware_2018}    \newline 
 \cite{tang_joint_2017}    \newline 
 \cite{tun_wireless_2019}    \newline 
 \cite{vo_slicing_2018}    \newline 
 \cite{wang_data-driven_2019}    \newline 
 \cite{wang_lra-3c_2019}    \newline 
 \cite{xiang_network_2017}    \newline 
 \cite{xun_hu_joint_2015}    \newline 
 \cite{ye_dynamic_nodate}    \newline 
 \cite{chang_ran_2018}   \textbf{Annotations extraites (15/01/2020 \`a 15:24:26)}"to realize the service-oriented 5G vision." (\href{zotero://open-pdf/library/items/57RV85XB?page=1}{Chang and Nikaein 2018:34018})"serviced-oriented RAN (SO-RAN)" (\href{zotero://open-pdf/library/items/57RV85XB?page=1}{Chang and Nikaein 2018:34018})"isolation and sharing" (\href{zotero://open-pdf/library/items/57RV85XB?page=1}{Chang and Nikaein 2018:34018})"multi-service RAN" (\href{zotero://open-pdf/library/items/57RV85XB?page=1}{Chang and Nikaein 2018:34018})"we propose a RAN runtime slicing" (\href{zotero://open-pdf/library/items/57RV85XB?page=1}{Chang and Nikaein 2018:34018})"customized" (\href{zotero://open-pdf/library/items/57RV85XB?page=1}{Chang and Nikaein 2018:34018})   \newline 
divers-new \cite{mo_optimization_2016}   \citet{mo_optimization_2016} investigated the optimal number of message replications for use in UNB/S IG F OX networks.~   \newline 
 \cite{terrasson_system_2014}   \citet{terrasson_system_2014} present an energy model for Ultra-Low Power sensor nodes. In these papers, the authors described the modeling of a sensor node dedicated to wireless sensor network applications. However, the RF module used in this study was the CC1100 module (a short range device) which did not include the LoRa technology. An other energy estimation model is presented in [Energy Consumption Estimation of Wireless Sensor Networks in Greenhouse Crop Production], The goal of this work is to obtain a low power consumption of sensor nodes.~   \newline 
 \cite{aguilar_opportunistic_2017}    \newline 
 \cite{alonso_middleware_2018}    \newline 
 \cite{bari_multi-attribute_2007}    \newline 
 \cite{boutaba_comprehensive_2018}    \newline 
 \cite{cardell-oliver_error_2012}    \newline 
 \cite{gan_genetic_2009}    \newline 
 \cite{jabbarpour_applications_2018}    \newline 
 \cite{joshi_artificial_2017}    \newline 
 \cite{juma_cooperative_nodate}    \newline 
 \cite{kempa_transient_2018}    \newline 
 \cite{li_equilibrium_2016}    \newline 
 \cite{madhavan_mastering_2015}    \newline 
 \cite{mahmoud_study_2016}    \newline 
 \cite{servi_m/m/1_2002}    \newline 
 \cite{springer_spread_2000}    \newline 
 \cite{barro_towards_2018}   This is how we thought to add the Wi-Fi protocol (which is part of the broad family of radio technologies and used for equipment implementing the IEEE 802.11x standard family) to the proposed model in \cite{barro_smart_2019} as it is able to achieve these goals. Indeed, it belongs to the Wi-Fi Alliance organization [Wi-Fi Alliance] and operates in the frequency band 2.5 GHz (for 802.11b, 802.11g or 802.11n) or 5 GHz for the 802.11a. We are also seeing continuous improvement of its technologies (see Table 1). Strictly speaking, we all know that sending naked data   \newline 
lora-adr \cite{bor_lora_2017}   \citet{bor_lora_2017} presented a capability and performance analysis of a LoRa transceiver and proposed LoRaBlink protocol for link-level parameter adaptation.\citet{bor_lora_2016} studied LoRa transceiver capabilities and the limit supported by LoRa system. They showed that LoRa networks can scale if they use dynamic selection of transmission parameters.For instance, \cite{bor_lora_2017} introduces an algorithm for selecting proper parameters considering a desired energy consumption and link quality. In [LoRa from the city to the mountains: Exploration of hardware and environmental factors], a measurement study shows that vegetation has a big impact on LoRa transmissions. The Spreading Factor (SF) and the transmission data rate have a significant impact on the network coverage according to \cite{augustin_study_2016}.~For example, in \cite{bor_lora_2017}, a transmission parameter selection algorithm for LoRa is presented with a goal to minimize energy consumption at a specific reliability level. To enable LoRaWAN to achieve a high data rate two different spreading factor allocations algorithms are presented in \cite{cuomo_explora_2017}.~\citet{bor_lora_2017} identified more than 6000 various parameter combinations for LoRa networks and developed an algorithm for automatic selection on LoRa transmission parameters. The performance measurements on our LoRa network also were related to some of their parameter selections.~\citet{bor_lora_nodate} also propose LoRaBlink, a MAC and routing cross-layer scheme, above the LoRa physical layer to extend the radio coverage of the gateway. LoRaBlink is self-organized network based on beacons (that contains distance in hops from the sink) and time-slotted channel access method. Their performance evaluation show that LoRaBlink may cover a network of 1.5 ha in a built up environment, achieve 80\textbackslash\% of reliability while having a potential lifetime of 2 years.\citet{bor_lora_nodate} conducted experiments using multiple nodes transmitting data using LoRa. Experiments were conducted in which two devices sent packets at different power levels, but the same spreading factor, to estimate the influence of concurrent transmissions. Additionally, a new media access control (MAC), LoRaBlink, was developed to enable direct connection of nodes without using LoRaWAN. Contrary to the above-mentioned work, we have not confined to a single base-station, but we have provided extensive measurements based on the large-scale ``The Things Networks'' network and for a duration of 8 months.~Similarly, a probing algorithm using trial and error method for selecting the optimal settings is illustrated in \cite{bor_lora_2017} These described methods converge to an optimal setting step by step after multiple transmissions for the fixed distance between the node and the gateways. However, such methods become unsuitable in moving node scenarios. The research involving LoRa moving nodes include several works.~\citet{bor_lora_2017} explore LoRa configuration parameters such as SF, bandwidth, coding rate and transmission power, which result in 6, 720 possible settings, and proposes an optimization problem that minimizes energy spent on data transmission while meeting required communication performance.~\citet{bor_lora_nodate} analyzed the access mechanism of the communication channel. From the obtained results, it can be seen that when the same SF (spreading factor) is used, by both the receiver and the transmitter, the packets are received even if a third node attempts to interfere with the transmission. Thus, the separation of channels by using different SF proves effective. One or two simultaneous transmissions can be received with high probability, if there is a separation of at least 3 symbol periods between them. The paper also analyzes the possibility of implementing a carrier activity detection mechanism. An algorithm for the automatic selection of communication parameters is presented in \cite{bor_lora_2017} so as to achieve a performance level as high as possible, at the same time ensuring energy efficiency.~Other works, such as \cite{bor_lora_2017}, examine the impact of the modulation parameters on the single communication link between an ED and its GW, without considering more complex network configurations. 2 Note that, from the GW perspective, ACK packets are not distinguishable from any other DL packet and, hence, are subject to the same rules and constraints.~In addition, the authors in \cite{bor_lora_2017} propose an link probing regime to select transmission parameters in order to achieve lower energy consumption.~In \cite{bor_lora_2017} the authors studied the impact of LoRa parameter settings (bandwith, coding rate, spreading factor, transmission power, etc.) on energy consumption and communication reliability. They proposed a mechanism to automatically select LoRa transmission parameters that satisfy the performance requirements. This solution is optimal for a given application scenario, but it is not convenient when traffic dynamically changes.~~   \newline 
 \cite{cuomo_explora_2017}   \citet{cuomo_explora_2017} propose algorithms to replace LoRa WAN adaptive data rate strategy. The proposed algorithms do not base the configuration of the spreading factor (SF) on distance and received power measurements, but take into account the number of connected devices, allowing the equalization of the time-on-air (ToA) of the packets in each SF.\citet{cuomo_explora_2017} extended the work on parallel transmission in a single-hop LoRa network. Specifically, these authors proposed to use the airtime to balance the nodes of each group with a specific SF and to attempt to use a high data rate to offload the traffic to less congested larger SFs. However, these strategies cannot be easily applied to a multi-hop LoRa network because of their lack of consideration in regards to multi-hop relays. In contrast to a single hop network in which the airtime of different groups is only decided by the number of nodes and their data rates, the airtime in a multi-hop network is also determined by the hop count of each subnet. Moreover, the connectivity between multiple relays is still not considered when conducting SF allocation in a single-hop LoRa network. B. SF ALLOCATION IN A MULTI-HOP NETWORK As compared to single-hop LoRa networks, multi-hop networks are more flexible to extend the coverage and more efficient to improve the data transmission without increasing the number of gateways. A practical strategy that transforms the topology from a star to a mesh network when the coverage range exceeds 3.2 km was proposed \cite{ochoa_evaluating_2017}.~In \cite{cuomo_explora_2017}, EXPLoRa-SF selects spreading factors based on the total number of connected nodes and EXPLoRa-AT equalizes the time-on-air of packets transmitted at the different spreading factors.~Authors in \cite{cuomo_explora_2017} proposed two SF allocation approaches, namely EXP-SF and EXP-AT, to help LoRaWAN achieve a high overall data rate. EXP-SF equally allocates SF s to N nodes based on the Received Signal Strength Indicator (RSSI), where the first N/6 nodes with the highest RSSI get SF 7 assigned and then the next N/6 nodes SF 8 and so on. EXP-AT is more dynamic than EXP-SF, where the SF allocation theoretically equalizes the airtime of nodes.~\citet{cuomo_explora_2017} suggest algorithms to replace LoRa WAN adaptive data rate strategy. The algorithms do not base the spreading factor (SF) configuration only on distance and received power, but also take into account the number of connected devices, equalizing the time-on-air (ToA) of packets in each SF.~Conversely, the EXPLoRa heuristic \cite{cuomo_explora_2017} aims to efficiently distribute the SFs among end-devices: the EXPLoRa-SF tries to equally distribute the SFs among the total number of nodes only constrained by the Receiver Signal Strength Indicator (RSSI) values. A more sophisticated approach, EXPLoRa-AT tries to equalize the Time-on-Air of the transmitted packets among the SF channels. The solutions presented in this paper are an upgrade of the latter approach by taking into account different traffic areas as well as variable payloads and message periods, thereby being able to precisely determine and equalize the traffic load for each SF channel, expressed in terms of symbol time.~~   \newline 
 \cite{kim_adaptive_2017}   \citet{kim_adaptive_2017} proposed a new ADR algorithm for LoRa networks at the nodes. Their algorithm requires an active feedback channel, i.e., an acknowledgment for every transmission. However, this mechanism would decrease the delivery ratio as downlink traffic has been demonstrated to have an impact on uplink throughput \cite{pop_does_2017}. In contrast, we show that ADR improves the efficiency of LoRa networks without the need for acknowledgments. There are a few articles which present simulation tools 4 to evaluate the performance of LoRa networks.~   \newline 
 \cite{lim_spreading_2018}   \citet{lim_spreading_2018} analyzed the LoRa technology to increase packet success probability and proposed three SF allocation schemes (equal interval based, equal area based, and random based). They found that the equal area scheme results in better performance compared with other schemes because of the reduced influence of SFs. The state of the art indicates the interest in heterogeneous deployments and SF allocation strategies. Thus, we analyze homogeneous and heterogeneous deployments with different SF allocations as a function of the number of nodes and traffic intensity in order to show network performance and the benefits of heterogeneity for large scale networks.~In \cite{lim_spreading_2018}, the authors analyze several SF configuration strategies where a group of LoRa devices can be configured with similar or heterogeneous SFs based on their position from the gateway. The goal is to find the scheme that gives the best performance in terms of PDR. However, the impact of the latter configuration on network slicing has not been previously tested. Few research works recently tackled network slicing in IoT and focused on machine critical communications over various wireless networks.   \newline 
 \cite{magrin_performance_2017}   \citet{magrin_performance_2017} implemented a model using the ns-3 simulator to study the performance in a typical urban environment. It was developed a path loss model where devices inside the buildings may be affected by building penetration losses. There were executed simulations with thousands of devices following a Pareto distribution. It was concluded that LoRaWAN with the ADR scheme may scale well only if there are numerous gateways suitably deployed across the system. i.e., a packet success rate of 95\textbackslash\% for 15000 devices is attained only if there are 75 gateways.~\cite{magrin_performance_2017} shows an assignment of SF to each ED based on the GW sensitivity by analyzing the radio frequency power signal at the GW. As a result, it lowers the probability of collisions and minimizes the ToA. Then, the GW is chosen based on the received power and SFs are allocated for the transmission. The GW is configured with 8 received paths with 3 channels in total. These receiving paths are assigned to each channel for uplink transmission. However, in this work, downlink transmission and confirmed mode are not considered.~\citet{magrin_performance_2017} developed a simulation model for the NS-3 network simulator with which they showed that LoRa networks support a large number of nodes and maintain reasonable network quality if several gateways are carefully placed.~The authors in \cite{magrin_performance_2017} proposed a complete LoRa module. It features MAC commands, diferent overlapping networks and multigateway support. Besides these interesting features, this module has some drawbacks. First, it can only send LoRa messages, so it is impossible to simulate the efect of interference. Next, similar chirp rates do not have efect on each other. Due to the chirp spread spectrum technique, spreading factor 9 with 125 kHz bandwidth has a similar chirp rate compared to spreading factor 11 with a 250 kHz bandwidth. Another small drawback is that all the gateways in this model are virtually directly connected to the network server, so the packets cannot be routed over IP.~   \newline 
 \cite{ochoa_evaluating_2017}   \citet{ochoa_evaluating_2017} analytically showed the potential gain of adaptive LoRa solutions that choose suitable radio parameters (i.e., spreading factor, bandwidth, and transmission power) to different deployment topologies (i.e., star and mesh). These studies provide a first view of LoRa performance and its limitations. As a conclusion we need to take into account the capture effect and imperfect orthogonality of SFs. We contribute with an accurate LoRa simulation model considering the co-channel SF interference and the gateway capture effect, allowing accurate performance analysis in large scale simulations for different deployment scenarios. Our study extends the previous evaluations of LoRa limits with the evaluation of reliability, network throughput, and power consumption from sparse to massive access deployment scenarios. D. LoRa Network Deployment Strategies Some authors studied LoRa network deployments and SF allocation strategies.~\citet{ochoa_evaluating_2017} proposed various strategies to adapt LoRa radio parameters to different deployment scenarios. Their simulation results showed that in a star topology, we can achieve the optimal scaling-up/down strategy of LoRa radio parameters to obtain either a high data rate or a long range while respecting low energy consumption. All the analyses show a large space for possible improvement of the LoRa performance. Nevertheless, the proposals for enhanced access methods need to take into account energy consumption along with performance, which is our goal in the next sections.   \newline 
 \cite{reynders_power_2017}   \citet{reynders_power_2017} developed a scheme to efficiently assign the SF and the transmission power across the devices.In \cite{reynders_power_2017}, the authors compute the optimal SFs distribution to minimize the collision4 probability and propose a scheme to improve the fairness for nodes far from the station by optimally assigning SFs and transmit power values to the network nodes, in order to reduce the packet error rate.In \cite{reynders_power_2017}, the authors present a scheme to optimize the packet error rate fairness to avoid near-far problems.~\citet{reynders_power_2017} presented and evaluated a mechanism to optimize the fairness of packet error rates among nodes with different spreading factors. We have applied a similar approach to derive the optimal distribution of spreading factors as a network-aware scheme in comparison with ADR+. However, the scenario considered in \cite{reynders_power_2017} is such that all nodes in the network can reach the gateway with every spreading factor and every power setting, i.e., all nodes are close to the gateway. In contrast, we consider a more realistic deployment scenario wherein nodes may only reach the gateway with specific spreading factors and transmission powers.~Similarly, in \cite{reynders_power_2017} power and spreading factor control algorithm is presented to achieve fairness in LoRa-based networks. Existing research work on LoRa has largely ignored the investigation of different channel access control protocols to improve the performance of LoRa in terms of reliability, throughput, and energy consumption. Therefore, here we focus on investigating the impact of a range of channel access control protocols on a LoRa-based network.~   \newline 
 \cite{slabicki_adaptive_2018}   \citet{slabicki_adaptive_2018} showed that a network-aware approach can further improve the delivery ratio of dense networks by using global knowledge of the node locations. However, the proposed algorithms based on ADR are not considered in the same way as for parallel transmission.~   \newline 
 \cite{to_simulation_2018}   \citet{to_simulation_2018} applied a Carrier-Sense Multiple Access (CSMA) technique to LoRa to improve LoRa scalability. When a node has a packet to send, it performs a Clear Channel Assessment (CCA) to test whether there is an ongoing transmission on a channel. The node transmits the packet only if the channel is clear; otherwise, it backs off for a random interval of time, with k slots of 1's, where k {$\in$} [ 0, 2 n - 1 ] . The authors further proposed CSMA-10, a variant of CSMA, where the node listens to the channel, named the Clear Channel Gap (CCG), for an interval of 10 ms before attempting transmission. Their experimental results show that the proposed method can mitigate the probability of packet collision. This allows the deployment of 5500 nodes with a 90\textbackslash\% PDR, whereas a general LoRaWAN deployment only allows less than 500 nodes to achieve the same packet delivery ratio.~   \newline 
 \cite{georgiou_low_2017}   In \cite{georgiou_low_2017} the effects of interference in a single gateway LoRa network have been investigated. Unlike other wireless networks, LoRa employs an adaptive chirp spread spectrum modulation scheme, thus extending the communication range in absence of any interference. Interference is however present when signals simultaneously collide in time, frequency, and spreading factor.Leveraging tools from stochastic geometry, the authors of \cite{georgiou_low_2017} have formulated and solved two link-outage conditions that can be used to evaluate the LoRA behavior.\citet{georgiou_low_2017} showed how the coverage probability drops exponentially as the number of network devices grows due to the interfering signals using the same spreading factor, which is concluded to be perhaps the most significant limits towards scalability on LoRa.~\citet{georgiou_low_2017} investigated the effects of interference in a network with a single gateway. They studied two link-outage conditions, one based on SNR and the other one based on co-SF interference. They showed, as expected, that performance decreases when the number of nodes increases and highlighted the interest of studying spatially heterogeneous deployments.~\citet{georgiou_low_2017} provide a stochastic geometry framework for modeling the performance of a single gateway LoRa network. They model the co-spreading factor interference assuming a single bandwidth frequency for all the nodes and they measure the outage and coverage probabilities based on the signal to noise ratio and the co-spreading sequence interference. Their analysis shows that the coverage probability drops exponentially as the number of end-devices grows due to interfering signals using the same spreading sequence.~\citet{georgiou_low_2017} provide a stochastic geometry framework for modeling the performance of a single channel LoRa network. Two independent link-outage conditions are studied, one which is related to SNR (i.e. range) and another one which is related to co-spreading factor interference. The authors argue that LoRa networks will inevitably become interference-limited, as end device coverage probability decays exponentially with increasing number of end devices. The authors report that this is mostly caused by co-spreading factor interference and that the low duty cycle and chirp orthogonality found in LoRa do little to mitigate this. Finally, the authors note that the lack of a packet-level software simulation is hindering the study into the performance of LoRa. It would be interesting to combine the authors' modeling of co-spreading factor interference with our ns-3 error model, as in the SINR approach all interference is treated as noise.~\citet{georgiou_low_2017} propose an analytic model that takes into account Rayleigh fading and allows to equate the coverage probabilities of nodes in a network considering two outage probabilities: disconnection and collision. Their work shows that LoRa networks are sensitive to network density.~As confirmed by \citet{georgiou_low_2017}, the exponential dependence of the TOA on SF introduces exponential upper bound on the network performance.~Several authors studied the issue of limits to the capacity of LoRa and its scalability to a large number of devices. \citet{georgiou_low_2017} provided a stochastic geometry framework for modeling the performance of a single gateway LoRa network. They showed that the coverage probability drops exponentially as the number of contending devices grows. They concluded that LoRa networks will become interference-limited rather than noise-limited in dense deployment scenarios because of the LoRaWAN access method.~\citet{georgiou_low_2017} propose an analytic model for LoRa coverage probability that takes into account Rayleigh fading, showing that LoRa networks are sensitive to network usage.~Concerning the modeling of communication fading, only \citet{georgiou_low_2017} and \citet{pop_does_2017} take this impairment into account. Several works have used measurements to evaluate the performance of LoRa networks.   \newline 
 \cite{hoeller_exploiting_2018}   LoRa networks have been gaining momentum as an accessible and open solution for massive connectivity in the Internet-of-Things. Besides the popularity, however, academic research has shown that the technology has limitations. In particular to the connectivity argument, it became clear that massive coverage comes at the price of severely reduced duty cycles, and the increased number of users in the network significantly elevates packet loss due to collisions. In this paper, we exploit time diversity to increase the probability of successful packet delivery in LoRa uplink. We build on previous work to model the outage and coverage probabilities of LoRa channels and analyze the use of message replication to create signal diversity. We observed that there is an optimum number of message replicas that minimizes outage probability and avoids high collision probability. We validate the proposed model using numerical simulations. \cite{bouzouita_estimating_2018}   \newline 
 \cite{callebaut_*cross-layer_2018}    \newline 
 \cite{chen_viable_2018}    \newline 
 \cite{dawaliby_adaptive_2019}    \newline 
 \cite{dix-matthews_lora_2018}    \newline 
 \cite{farooq_search_2018}    \newline 
 \cite{hoeller_analysis_2018}    \newline 
 \cite{karmakar_linkcon_2017}    \newline 
 \cite{kerkouche_node-based_2018}    \newline 
 \cite{kim_experiencing_2019}    \newline 
 \cite{ochoa_large_2018}    \newline 
 \cite{orfanidis_investigating_2017}    \newline 
 \cite{piva_impact_2017}    \newline 
 \cite{rezende_adaptive_2018}    \newline 
 \cite{sandoval_optimal_2018}    \newline 
 \cite{zhou_novel_2019}    \newline 
 \cite{zhu_improving_2019}    \newline 
 \cite{zorbas_improving_2018}    \newline 
 \cite{gupta_battery_2019}   [object Object]   \newline 
 \cite{bor_lora_2016}   \textbf{Annotations extraites (15/01/2020 \`a 15:24:10)}"SN = fT P; CF; SF; BW; CR; ; Bg." (\href{zotero://open-pdf/library/items/I4JZZ98I?page=6}{Bor et al 2016:64})   \newline 
 \cite{blaszczyszyn_analyzing_2019}   They prrpose a stochastic-geometric modelThey assume a space-time Poisson model of packets transmitted by LoRA nodes   \newline 
 \cite{li_2d_2016}   To obtain more general results, \cite{li_2d_2016} uses a stochastic geometry model to jointly analyze interference in the time and frequency domains. It is observed that when implementing a packet repetition strategy, i.e., transmitting each message multiple times, the failure probability reduces, but clearly the average throughput decreases because of the introduced redundancy.~   \newline 
lora-adr-LoRaWAN \cite{blenn_lorawan_2017}   \citet{blenn_lorawan_2017} performed simulations based on traces from experiments and analyzed results based on real life and large scale measurements from The Things Network but their simulations are limited to the deployed scenario. To and Duda \cite{to_simulation_2018} presented LoRa simulations in NS-3 validated in testbed experiments. They considered the capture effect and showed the reduction of the packet drop rate due to collisions with a CSMA approach.~\citet{blenn_lorawan_2017} obtained a series of experimental and empirical results by analyzing the influence of the payload on the quality of the received signal. The experiments have been conducted over an 8-month period, with the results showing that the LoRa channel occupancy rate is not evenly distributed, a fact that contributes to a decrease in performance. This phenomenon is based on the fact that the majority of LoRa nodes use the default settings programmed by the manufacturer, a fact that causes the overload of certain channels. The purpose of the paper was to use certain user-defined communication channels according to the RF (Radiofrequency) environment congestion.~   \newline 
 \cite{casals_modeling_2017}   \citet{casals_modeling_2017} developed current models that allow the characterization of LoRaWAN devices lifetime and energy cost. The proposed models were very important and derived from measurement results using a currently prevalent LoRaWAN platform.~However, \citet{casals_modeling_2017} did not include the energy consumption of the processing and the sensor units. In our paper, we have modeled these units for an application scenario of connected sensor. Another major difference is that we have illustrated our energy model with optimization of LoRaWAN parameters such as the spreading factor SF, the coding rate CR, the bandwidth BW, the payload size and the communication range. Optimizing these parameters is very important to reduce the energy consumption of the sensor node. The previous works were proposed to estimate the amount of energy consumption by a sensor node. Some of these studies have not included LoRa technology into their energy models, so they used different RF transceivers which are mainly dedicated to short range communication. Other works did not study the energy optimization of sensor nodes. In fact, optimizing LoRa and LoRaWAN parameters are very interesting to reduce the energy consumption by the communicating sensor.~   \newline 
 \cite{cheong_comparison_2017}   \citet{cheong_comparison_2017} proposed a comparison of LoRaWAN classes and their power consumption. The objective of this study is to offer an experimental comparison of LoRaWAN classes to verify the published current levels of different operating modes in LoRa datasheets. The measurement results allow to estimate the lifetime of end-node devices. However, in this paper, the authors did not study the effect of different LoRaWAN parameters such as coding rate, communication range and transmission power level on the total consumed energy.~   \newline 
 \cite{feltrin_lorawan_2018}   \citet{feltrin_lorawan_2018} discussed the role of LoRaWAN for IoT and showed its application to many use cases. They considered the effect of non perfect orthogonality of SFs for a link level analysis.~   \newline 
 \cite{adelantado_understanding_2017}   In \cite{adelantado_understanding_2017}, the authors focus on the performance impact of LoRa on higher layers. otably from their work is that the down-link receive window is seen as the limiting factor. This work, like the others, identifies that the main scalability limit of LoRa is its channel access protocol (essentially ALOHA) together with its rather expensive packet acknowledgements.\citet{adelantado_understanding_2017} also calculate LoRaWAN capacity as the superposition of independent ALOHA-based networks (one for each channel and for each SF). In conclusion, analyses based on pure ALOHA, fail to adequately model interference in LoRaWAN networks and therefor underestimate the capacity of LoRaWAN LPWANs.~\citet{adelantado_understanding_2017} referred to the duty-cycle constraint as a major factor limiting LoRa MAC performance. A higher SF value allows a wider communication range but also increases the ToA, which inevitably leads to an increase in the off-period duration under the constraint. The problem can be serious because, generally, nodes using high SF values are much more numerous than nodes using low SF values. The study applied 3 channels and a 1\textbackslash\% duty cycle as the fixed parameters and simulated the packet reception ratio for a given packet length and number of nodes. As a result, although the packet length is small at 10 bytes, the packet reception rate decreases exponentially because of the increasing number of collisions as the number of nodes increases. Notably, it converges to almost zero when more than 1500 nodes are deployed. On the contrary, a small number of nodes decreases the probability of collision, but the throughput is limited by the duty cycle.~In \cite{adelantado_understanding_2017}, some interesting insights on the limits of LoRaWAN R are given, but again the model is based on Poisson process and there is no possible extension to account for the capture effect. In this article, in order to give the limit of the performance, we study the outage probability and throughput of LoRaWAN R and Sigfox R when every node is transmitting as frequently as possible, according to either the ISM band duty cycle constraints or technology-related constraints, which result in message sending periods in the order of 1 to 10 minutes. This scenario of the saturation throughput could be that of packet and object tracking systems [The internet of things: a survey. Information Systems Frontiers]. Other less frequent IoT scenarios such as water \textbackslash\& gas metering can be evaluated using our model thanks to its flexibility.~As \citet{adelantado_understanding_2017} state, the throughput of the network is upper-bound either by the collision rate (lower DR, shorter TOA) or by the duty-cycle limitation (higher DR, longer TOA). The systems containing end-nodes whose transmission parameters are constant with respect to time are particularly affected.~\citet{adelantado_understanding_2017} showed that an excessive number of nodes (28 \textbackslash\% of the network) should use the largest SF (SF12) to ensure the coverage of urban cells. This approach only considered the path loss and ignored the airtime when using SF12.~On the contrary, although LoRaWAN is rising with a promising future, \citet{adelantado_understanding_2017} give an objective description of limitations of LoRaWAN in accordance with the development questions in research and application.~\citet{adelantado_understanding_2017} explored LoRa from the point of view of the capacity and the network size. They observed that for low duty cycles, throughput is limited by collisions, whereas for higher duty cycle values, the maximum duty cycle set by the ETSI regulations prevents devices from increasing their packet transmission rates and limits throughput. For instance, for 1000 devices, the maximum packet rate per node is 38 pkt/hour (packets of 50 B) with the probability of successful reception of only 13\textbackslash\%.~\citet{adelantado_understanding_2017} detailed the characteristics and limits of LoRa/LoRaWAN in terms of the relationships between duty cycle and throughput with various packet sizes. Duty cycle defines the ratio of the time that a device can transmit data, in order to regulate signal transmission and avoid signal collisions. They described how LoRa can be used in real-time monitoring, metering, smart transportation and logistics, but not for video surveillance.~   \newline 
 \cite{hauser_proposal_2017}   In \cite{hauser_proposal_2017}, additions such as adjusting data rates before incrementing Tx, the averaging of SNR history and accounting for hysteresis is recommended.~In [Lorawan specification] and \cite{hauser_proposal_2017}, adaptive data rate (ADR) method is specified for energy optimization in static nodes. ADR involves adaptation of LoRa transmission parameters to save transmission energy using feedback mechanism based on previous communications.   \newline 
 \cite{reynders_lorawan_2018}   In \cite{reynders_lorawan_2018} a module for the ns-3 simulator is proposed and used for a similar scope, comparing the singleand multigateway scenarios and the use of unconfirmed and confirmed messages. In this case, the authors correctly implement the GW's multiple reception paths, but do not take into account their association to a specific UL frequency, which usually occurs during network setup: indeed, the number of packets that can be received simultaneously on a given frequency can not be greater than the number of reception paths that are listening on that frequency. Also in this case, the study only focuses on the performance analysis, without proposing any improvement.~   \newline 
 \cite{toussaint_performance_2016}   In \cite{toussaint_performance_2016}, only the energy related to the activation of a LoRaWAN node by using the On-The-Air Activation (OTAA) mode is modeled.~   \newline 
 \cite{abeele_scalability_2017}   In order to tackle the interference and capture effect, an error model is described in \cite{abeele_scalability_2017}. This model is used for determining the range between EDs and a GW as well as analyzing the interference among various concurrent communications. The algorithm considers three different methods for assigning an efficient SF: (i) a random assignment method which assigns SFs based on uniform distribution mechanism, (ii) a fixed assignment method which assigns the same SFs all the time during the simulation period, (iii) Packet Error Rate (PER) based which finds and allocates the lowest SF for which the PER falls under a certain threshold. The PER approach for finding a suitable SF performs better than both the random and fixed-based SF assignment methods and can play a vital role in enhancing the packet delivery ratio.~\citet{abeele_scalability_2017} studied the capacity and scalability of LoRaWAN for thousands of nodes per gateway. They showed the importance of considering the capture effect and interference models. They proposed an error model from BER simulations to determine communication ranges and interference. They also analyzed three strategies of network deployments (random SF allocation, a fixed one, and according to related PDR), the last one presenting the best performance.~\citet{abeele_scalability_2017} using a LoRa ns-3 module, perform a scalability analysis of LoRaWAN. Their work shows detrimental impact of the downstream traffic on the delivery ratio of the upstream traffic. They, also, show that increasing gateway density can ameliorate but not eliminate this effect, as stringent duty cycle requirements for gateways continue to limit downstream opportunities. The same authors show through simulations that LoRaWAN can send six times more traffic compared to pure Aloha in a single-cell LoRaWAN network for the same number of end devices per gateway when the 125-kHz channel bandwidth is used \cite{jetmir_haxhibeqiri_lora_2017}.~\citet{abeele_scalability_2017} analyzed the scalability of large-scale LoRaWAN using the NS-3 simulator. LoRa MAC has been modeled as a pure ALOHA network that does not consider the capture effect or interference characteristics. Instead, the authors generated a LoRa error model from a preliminary simulation that measured the bit error rate on the baseband and used it as an interference model in the simulator. The simulation result shows that the packet reception ratio varies depending on how SF values are assigned when nodes are deployed. Performance is very poor when all nodes have the same SF. Assigning SF values randomly results in better performance than the fixed SF assignment, but it is still low: only a 20\textbackslash\% ratio with 5000 nodes. They improved the performance by about two times compared with the random assignment method by using a PER (packet error rate) strategy that assigns the minimum SF value at which the PER falls below a certain threshold. The authors ran another experiment that set the size of an application payload to 8 bytes and used a single channel. In this experiment, they increased the data period from 600 s to 60,000 s, varied the number of gateways from 1 to 4, and then evaluated MAC performance. Their results confirm that the PDR increases exponentially as the data period increases. With respect to the gateways, the PDR achieves 70\textbackslash\%, 89\textbackslash\%, and 96\textbackslash\% when 1, 2, and 4 gateways are deployed in an area with 10,000 nodes that send data every 600 s. This illustrates the possibility of using multiple gateways to improve LoRa performance in a dense environment. Our experiments used the LBT scheme on multiple channels, so it is impossible to compare our results to theirs directly. However, both results indicate that there is a trade-off between the number of nodes and the data period to achieve a given level of LoRa MAC performance.~In \cite{abeele_scalability_2017}, system-level simulations are again employed to assess the performance of confirmed and unconfirmed messages and show the detrimental impact of confirmation traffic on the overall network capacity and throughput. Here, the only proposed solution is the use of multiple gateways, without deeply investigating the specificities of the LoRaWAN standard.~~\citet{abeele_scalability_2017} presented a LoRa simulator based on ns-3. The work characterizes the scalability in scenarios with both uplink and downlink transmissions; however, it does not consider dynamic configuration of transmission parameters.~~   \newline 
 \cite{sorensen_analysis_2017}   Network throughput, latency and collision rate for uplink transmissions are analyzed in \cite{sorensen_analysis_2017} that, using queueing theory and considering the Aloha channel access protocol and the regulatory constrains in the use of the different sub-bands, points out the importance of a clever splitting of the traffic in the available sub-bands to improve the network performance.~\citet{sorensen_analysis_2017} have investigated the performance of LoRaWAN including delay, collision rate, and throughput. These articles have provided valuable works for the research in this paper. According to the literature review, most of the works about LoRa has focused on the study of the network characteristics such as coverage, time delay, or energy consumption. As we know, the network performance and the availability such as collision rate and SDR are significant in elderly care solutions. Moreover, the data delivery policy among the nodes and the gateway in the star topology network is very important for avoiding packets collision and increasing SDR. But it has been carried out limited studies. Therefore, we mainly focus on the performance improvement and optimal cluster allocation policies for maximizing SDR in LoRaWAN. The network QoS factors, including average time delay, SDR and energy consumption, are analyzed. Based on this topic, a smart WPSN solution in elderly care system is implemented and evaluated experimentally.~~   \newline 
 \cite{barro_lorawan_nodate}    \newline 
 \cite{bouguera_energy_2018}    \newline 
 \cite{capuzzo_*confirmed_2018}    \newline 
 \cite{cuomo_towards_2018}    \newline 
 \cite{farhad_scalability_2019}    \newline 
 \cite{lavric_performance_2018}    \newline 
 \cite{marais_evaluating_2019}    \newline 
 \cite{marais_lora_2017}    \newline 
 \cite{montavont_enhanced_2018}    \newline 
 \cite{yang_smart_2018}    \newline 
 \cite{magrin_thorough_2019}   [object Object]   \newline 
 \cite{abdelfadeel_fair_2018}   On the other hand, \citet{abdelfadeel_fair_2018} presented a fair adaptive data rate algorithm (FADR) which computes a data-rate and transmission power allocation in order to achieve fairness in data-rate and reduce collision among nodes.   \newline 
 \cite{pop_does_2017}   The recent work presented by \citet{pop_does_2017} studies the impact of bidirectional traffic in LoRaWAN by extending the LoRaSim simulator to include bidirectional LoRaWAN communication. The resulting simulator is named LoRaWANSim. Both our ns-3 module and LoRaWANSim allow to study the scalability of LoRaWAN networks. Both works find that duty cycle limitations at the gateway limit the number of downlink messages (Ack or data) a gateway can send. This problem grows worse as the end device density increases, but can be partially mitigated by increasing gateway density (see section V-C).The authors of \cite{pop_does_2017} correctly identify that the absence of an acknowledgement, does not necessarily mean that the link quality has decreased and that a node should decrease its data rate for subsequent retransmissions.~Actually, decreasing the data rate might exacerbate this problem as detailed in \cite{pop_does_2017}. Notable differences between the two simulators include that the LoRaWANSim manuscript is limited to single gateway network, while the ns-3 module provides support for multi-gateway LoRaWAN networks. Secondly, the collision models are quite different. The ns-3 module builds on the error model derived from the complex baseband BER simulations, while LoRaWANSim reuses the empirical model from LoRaSim. Both collision models support the capture effect as well as modeling interference. Under capture effect, we understand the ability to receive an interfered transmission in the presence of one or more interferers as long as the SNR of the interfered transmission is sufficiently high for the transmission to be received error-free. The LoRaWANSim collision model incorrectly assumes perfect orthogonality between spreading factors, while the ns-3 module counts every transmission on the same channel with a different spreading factor as interference. Furthermore, the LoRaWANSim manuscript does not mention the 10\textbackslash\% RDC restriction that applies in the sub- band of the RW2 channel in the EU. This underestimates the downlink capacity in RW2. Thirdly, the SpectrumPhy model for the LoRa PHY in ns-3 enables modeling inter-technology interference, which could facilitate studies on the interference between 802.11ah on LoRaWAN. Finally, the LoRaWANSim simulator does not appear to be open source although the manuscript is still under revision at this time.~~\citet{pop_does_2017} evaluated how LoRa WAN downlink impacts LoRa uplink goodput and coverage probability. They considered the medium access control (MAC) layer and, through simulations, verified that if too many end-devices request delivery confirmation, the downlink becomes unstable and unable to deliver several acknowledgment packets, thus forcing network nodes to retry their transmissions, ultimately flooding the network.~The study presented in \cite{pop_does_2017} features a system-level analysis of LoRaWAN, and gives significant insights on bottlenecks and network behavior in presence of downlink traffic. However, besides pointing out some flaws in the design of the LoRaWAN medium access scheme, this work does not propose any way to improve the performance of the technology.~\citet{pop_does_2017} extended the LoRaSim simulator by adding support for downlink transmissions. The authors demonstrated that downlink transmissions in the network actually decrease the communication performance of the wireless connections.~\citet{pop_does_2017} evaluated the impact of the LoRa WAN downlink on the uplink goodput and coverage probability. They verified that the downlink becomes unable to deliver several acknowledgment packets if too many end-devices request delivery confirmation.~~   \newline 
lora-adr-new \cite{pham_qos_2016}   Activity Time Sharing Mechanism: \cite{pham_qos_2016}, proposes a mechanism for sharing the channel occupancy time in order to improve the overall performance of the network. We give more details on this mechanism, to which we are interested in our work.\cite{pham_qos_2016} proposed an activity time sharing mechanism in a long-range unlicensed LoRa network to face the problem of activity time limitation in the case of video surveillance applications. The proposed mechanism supposes that all devices that will participate in the sharing mechanism register with the LoRa gateway and announce their local remaining activity time (initially can be the total authorized activity time or just a fraction). Thus, the gateway computes the global activity time allowed for usage which can be an addition of the allowed time of each device ``Global Time'' (1) or just a fraction of it. After it informs it to all devices which will share it. This step is performed each cycle (every hour). As long as this global activity time allows, a node Di that exhausts its duty cycle (allocated activity time) and needs additional time to send its data borrows the remaining time from the global time. A global view of the total remaining activity time is maintained by the LoRa Gateway (LR-BS) on reception of packets and sent back to devices at the appropriate moments.GlobalT ime = n \texttimes{} 36 s (1) In \cite{pham_qos_2016}, the author did not evaluate nor propose a mechanism for selecting devices that will benefit the shared extra time. Indeed, he limited himself to serving the first applicant.Moreover, \cite{pham_qos_2016} assumes that all the nodes participating in the sharing mechanism must be on standby to be able to receive from the gateway the updated information of the global activity time and the list of nodes involved in the loan. Otherwise they must wake-up periodically to receive this update. This would not correspond to the behavior of class A nodes but rather to class B nodes. We believe that the activity time sharing mechanism proposed in \cite{pham_qos_2016} improves the quality of service but lacks an additional time allocation mechanism by a priority classification or a strategy that satisfies a larger number of requesting devices taking into account the range of a device and its battery level in the management of the allocation of additional time. In the next section, we will describe our solution to those above-mentioned issues.   \newline 
 \cite{deek_joint_2013}   \citet{deek_joint_2013} proposed a rate adaptation scheme based on channel bonding. But, the mechanism can not utilize the full strength of all PHY/MAC new features. Minstrel [Multiband Atheros Driver for WiFi] is the default link adaptation algorithm in Linux system and engages the statistical information for channel overhearing. However, it is suitable only for legacy IEEE 802.11 systems.   \newline 
 \cite{feng_frame-aggregated_2010}   \citet{feng_frame-aggregated_2010} developed a link adaptation scheme that applies frame aggregation. All these mechanisms do not consider all PHY/MAC enhancements of HT-WLANs along with their internal trade-offs. Thus, these approaches are not able to meet theoretical achievable data rate of IEEE 802.11n/ac in practical scenarios. Minstrel HT [New Rate Control Module for 802.11n] is the default rate adaptation methodology that is applied by the wireless driver ath9k [-802.11n Wireless Driver]. It perceives the maximum enhancements of PHY/MAC in IEEE 802.11n, but suffers from exhaustive sampling. SampleLite [A Hybrid Approach to 802.11n Link Adaptation] is a pure received signal strength indicator (RSSI) threshold-based algorithm. It can not cope up with all possible wireless network scenarios.   \newline 
 \cite{qiuyan_xia_open-loop_2009}   Different MCS values and MIMO are used in \cite{das_link_2008} \cite{qiuyan_xia_open-loop_2009}.   \newline 
 \cite{chen_ram_2012}   However, \citet{chen_ram_2012} proposed a rate adaptation algorithm, RAM, for mobile environment considering only legacy IEEE 802.11 standards. Hence, it is not adjustable with HT-WLANs.   \newline 
 \cite{karmakar_dynamic_2015}   In one of our previous works \cite{karmakar_dynamic_2015}, a dynamic link adaptation scheme is designed for IEEE 802.11n. In this work, we consider a limited set of channel conditions measured by RSSI.   \newline 
 \cite{karmakar_dynamic_2016}   In our another work \cite{karmakar_dynamic_2016}, an adaptive learner is designed for link adaptation in IEEE 802.11ac. Sur et al. [Practical MU-MIMO user selection on 802.11ac commodity networks] designed MUSE that is a MU-MIMO-based rate adaptation algorithm for IEEE 802.11ac networks.   \newline 
 \cite{al-turjman_mobile_2017}    \newline 
 \cite{chevillat_dynamic_2005}    \newline 
 \cite{fu_stochastic_2013}    \newline 
 \cite{lacage_ieee_2004}    \newline 
 \cite{lin_atpc_2006}    \newline 
 \cite{monks_power_2001}    \newline 
 \cite{nguyen_practical_2011}    \newline 
 \cite{noauthor_survey_2013}    \newline 
 \cite{pefkianakis_window-based_2013}    \newline 
 \cite{ramachandran_symphony_2010}    \newline 
 \cite{wong_robust_2006}    \newline 
 \cite{zimmerling_ptunes_2012}    \newline 
lora-channel \cite{liew_fast_2018}   A more recent proposal \cite{liew_fast_2018} involved a multi-channel multi-path data collection protocol based on Basketball Net Topology (BNT), which maintains not only a tree-based topology but also the connectivities between peer nodes located at the same height in the tree. This protocol enables child nodes to rejoin the network, even when their parent node disappeared from the original tree structure, by using peer links to communicate with other nodes. However, the connectivities of peers extend the hop counts to the sink node, which inversely increases the airtime of the entire network. The use of LoRa enables the coverage range to be extended when a lower data rate with a larger SF is chosen. As compared to multi-channel assignment algorithms, we needed to consider an approach that would decrease the hop count of each sub-tree using a different SF while ensuring that the airtime between different sub-trees remains balanced.~   \newline 
 \cite{bankov_mathematical_2017}   \citet{bankov_mathematical_2017} consider LoRaWAN networks with class A devices operating in acknowledged mode. They detail the data transmission process, considering the difference between power of the signal from different devices and the capture effect. Indeed, they developed a generic mathematical model which can be employed to evaluate network capacity and transmission reliability of LoRaWAN networks when considering Okumura-Hata model for propagation losses. In this paper, unlike other works, we thoroughly study LoRa performance by presenting both packet success probability as well as the average success probability per frequency and spreading factor configuration as a function of distance and density. We solve an optimization problem for each frequency to find the optimal mix of nodes with different configurations that maximize the density and do not violate a minimum average success probability.~\citet{bankov_mathematical_2017} proposed a mathematical model for LoRa WAN channel access taking into account the capture effect and using the Okumura-Hata model, but without fading.~A mathematical model of the access mechanism to the communication channel is presented in \cite{bankov_mathematical_2017}. A certain threshold of the network load is also calculated in this paper by estimating the throughput. When this threshold value is reached, the PER (Packet Error Rate) parameter increases rapidly towards 1, because the packet relaying causes an avalanche effect leading to the saturation of the communication channel.~\% ----------------------------------------------------- In \cite{bankov_mathematical_2017} the authors present a mathematical model of the network performance, taking into account factors such as the capture effect and a realistic distribution of SFs in the network. However, the model does not include some important network parameters, preventing the study of their effect on the network perfomance.   \newline 
 \cite{song_evaluation_2017}   \citet{song_evaluation_2017} consider the macro reception diversity of long-range ALOHA networks, where augmented spatial diversity arises from allowing several base stations to receive the same packet.~   \newline 
 \cite{halperin_predictable_2010}   ESNR is an another rate selection scheme designed in \cite{halperin_predictable_2010}. Specifically, it was designed for IEEE 802.11n (MIMO). All new features of HT-WLANs are not employed in MUSE and ESNR. Moreover, their performances were not evaluated in mobile environment. (ii) Link adaptation in mobile environment: As per our knowledge, no work has yet considered SDN-based framework to design a dynamic link adaptation algorithm for HT-WLANs in mobile environment.   \newline 
 \cite{bankov_limits_nodate}   In \cite{bankov_limits_2016} authors model LoRaWAN performance analytically in a scenario with high number of devices and propose solutions to improve its performance. Most of the current studies are based on simulation results.~   \newline 
 \cite{goursaud_random_2016}   In \cite{goursaud_random_2016}, the performances of a random Frequency Division Multiple Access (random FDMA) scenario are studied in the pure Aloha case, but the capture effect with little overlap between packets is not considered.~   \newline 
 \cite{wu_realistic_2008}   In data collection networks, the proposed protocols \cite{wu_realistic_2008}, \cite{liew_fast_2018} usually construct a static channel assignment approach to maintain the simplicity of channel coordination.Other researchers \cite{wu_realistic_2008} proposed TMCP to assign different channels to disjoint trees and operate parallel transmissions among sub-trees for data collection. However, the paper does not discuss the balance between different sub-trees.~   \newline 
 \cite{angelakis_allocation_2016}    \newline 
 \cite{cui_partially_2011}    \newline 
 \cite{jorke_urban_2017}    \newline 
 \cite{krendzel_wireless_2012}    \newline 
 \cite{masonta_adaptive_2015}    \newline 
 \cite{muqattash_single-channel_2004}    \newline 
 \cite{tang_intelligent_2018}   utiliser un blockchain pour l'assignement de canal   \newline 
lora-new \cite{kim_contention-aware_2018}   A contention aware ADR approach, proposed by \cite{kim_contention-aware_2018}, tracks the number of nodes per SF and aims to increase the number of devices using low SFs in order to maximise the network's throughput.   \newline 
 \cite{barro_tltn_2019}   A first study \cite{barro_tltn_2019} was conducted on stand-alone LoRaWAN base stations that can operate even when Internet is intermittent or non-existent and that have the ability to communicate with each other \cite{barro_smart_2019}, in order to form a city size extensive network. In this paper, we will first look at the indexes as well as at the practitioners, to find the existing tools or to make one, in order to ensure a good coverage study based on this concept and, then, to propose a testBed for this purpose.~   \newline 
 \cite{petajajarvi_coverage_2015}   A measurement based assessment of LoRa was also carried out in \cite{petajajarvi_coverage_2015}, which captures the Received Signal Strength Indicator (RSSI) by different locations from the base station and derives an heat map able to characterize performance as a function of the distance and of the environmental conditions (on water and on the groud). The paper also derives a channel attenuation model based on the presented measurements results.~\citeauthor{petajajarvi_coverage_2015}, present an evaluation of LoRa link behaviour in open spaces. We evaluated LoRa link behaviour in built-up environments. We built upon the results reported in these papers when constructing our communication models for LoRaSim (see Section 3). This previous work, however, does not address general scalability questions of LoRa.~The expected coverage of LPWANs and especially LoRa was also analyzed by \citet{petajajarvi_coverage_2015}, who conducted measurements in Finland. Using a single base-station with an antenna gain of 2 dBi and configuring the nodes to send packets at SF12 using 14 dBm of transmit power, connectivity within a 5 km range in urban environments and 15 km in open space were found to result in packet-loss ratios smaller than 30\textbackslash\%. Measurements conducted by sending packets from a node mounted to a boat revealed that packets can be sent over a distance of almost 30 km.~As reported by \citet{petajajarvi_coverage_2015}, the performance of the LoRa \textregistered{} modulation is satisfactory in real-life environment experiments even under relatively strict European regulations [ERC Recommendation 70-03 relating to the use of Short Range Devices, p. 7, band h1.4]. Although multiple simultaneously emitted LoRa \textregistered{} transmissions can be processed by a single gateway exploiting the orthogonality of the spreading factors in addition to using multiple transmission sub-bands, the nature of the ALOHAbased access to the medium inevitably leads to the presence of transmission collisions.~~   \newline 
 \cite{reynders_improving_2018}   Another approach, RS-LoRa MAC protocol, aims to improve the reliability and scalability of LoRaWAN under free space path loss model \cite{reynders_improving_2018}. RS-LoRa works in two major steps; in the first step, the GW is responsible for scheduling EDs within its range by measuring the Received Signal Strength Indicator (RSSI) and SF for each channel. In the second step, each ED decides its SF, transmission power, and channel based on the information provided by the GW. This scheduling reduces the collision by carefully selecting an SF in order to improve network reliability, scalability, and capture effect.\citet{reynders_improving_2018} provided SF distribution scheme to balance the packet error rate \cite{reynders_power_2017} and lightweight scheduling to group the nodes into different power level and selected SFs to improve the reliability and scalability of the LoRaWAN network.   \newline 
 \cite{haxhibeqiri_lora_2017}   Another coverage study focused on LoRa, was presented in \cite{haxhibeqiri_lora_2017}, but, in this case it was carried out in an indoor scenario. The presented outcomes demonstrated the robustness of LoRa in adverse industrial environments, even with high data-rates.   \newline 
 \cite{marcelis_dare_2017}   \cite{marcelis_dare_2017} measured the spatial and temporal properties of LoRaWAN channels using both static and mobile transmitters. They found that channels at the limits of the transmission range (7.5km) had very low packet reception rates. An efficient coding scheme based on convolutional codes and fountain codes was proposed for data recovery. Their experiments show that with this protocol 99\textbackslash\% of the data can be recovered and that, for 10 byte packets, it has 21\textbackslash\% more data recovery and 42\textbackslash\% lower energy consumption than a naive repetition coding protocol. Research Gaps. Developing a generalized methodology for determining the best parameter values to use for very low power LoRa applications remains an open research question. Another open question is what is the best strategy for achieving high data delivery rate with low energy use. It has been shown that high data delivery rates can be achieved without over-engineering a setting to achieve the highest packet reception rate \cite{marco_cattani_experimental_2017}\cite{marcelis_dare_2017}. This paper develops this line of thinking and demonstrates that the LoRa physical layer with data-aware repetition coding is an efective solution for achieving reliable and very low energy LoRa-based sensor networks.~   \newline 
 \cite{atanasovski_long-range_2015}   \citet{atanasovski_long-range_2015} present LoRa as ``one of the most promising technologies for the wide-area IoT'' and mention that LoRa exhibits certain advantages over the LPWAN technologies Sigfox TM , Weightless TM , and On-Ramp Wireless. The robust chirp signal modulation and the low energy usage in combination with the low cost of end-devices together with the fact that the LoRa Alliance is also actively marketing and pushing interoperability aspects, makes LoRaWAN an interesting choice among available LPWAN technologies.~   \newline 
 \cite{bonnefoi_improvement_2018}   \citet{bonnefoi_improvement_2018} present reinforcement learning algorithms to reduce the collision probability and the network latency.~   \newline 
 \cite{bor_lora_2016-1}   \citet{bor_lora_2016} provide a LoRa link behaviour by using practical experiments able to describe (i) communication range in dependence of communication settings of SF and Bandwidth (BW) and (ii) capture effect of LoRa transmissions depending on transmission timings and power. They also provided a LoRa simulator (LoRaSim) and evaluated the LoRa scalability limits in static settings comprising a single sink, and assessed how such limits can be overcome with multiple sinks and dynamic communication parameter settings.~\citet{bor_lora_2016} present LoRaSim, a simulator to evaluate the scalability of LoRa networks. The authors detail range of communication options (carrier frequency, spreading factor, bandwidth and coding rate) for a transmitter. Moreover, they study the collision avoidance scenarios as well as the maximum number of transmitters in a LoRa network. Their evaluation results show that to keep the Data Extraction Rate above 0.9, only 120 users are supported per antenna using standard LoRa settings.~The work of \citet{bor_lora_2016} studies the limit on the number of transmitters supported by a LoRa system based on an empirical model. The authors performed practical experiments that quantify communication range and capture effect of LoRatransmissions. These findings were used to build a purposebuilt simulator, LoRaSim, with the goal of studying the scalability of LoRa networks. The authors conclude that LoRa networks can scale quite well if they use dynamic transmissions parameter selection and/or multiple sinks. Our study confirms that multiple sinks drastically improve scalability, even though we use a very different approach for modeling interference. Furthermore, our study goes deeper into modeling LoRaWAN as the LoRaWAN MAC layer is modeled and the impact of confirmed messages and downstream traffic is studied.~\citet{bor_lora_nodate} developed a LoRa simulation to study its scalability. They showed that a typical Smart City deployment can support 120 nodes per 3.8 ha, which is not sufficient for future IoT deployments.~\citet{bor_lora_2016} experimentally observed the capture effect of LoRa and modeled the capacity of such networks, concluding that LoRa networks with only one gateway and conservative operational parameters do not scale well, while networks with dynamic adaptation of operating parameters or multiple gateways tend to scale better.~\citet{bor_lora_2016} developed a Python-based discrete event simulator (called LoRaSim) to characterize the capacity of LoRa networks. However, the simulator supports only uplink transmissions from nodes to the gateway; thus, it cannot be used to evaluate ADR.~As a partial solution, \citet{bor_lora_2016} suggest implementing a dynamic transmission scheme, i.e. ADR in LoRaWANTM, and to densify the infrastructure by adding additional gateways. Since as seen by the network operators, the implementation of an ADR is a CAPEX-efficient way to optimize the capacity of the networks, vendors offering NM on the market keep their algorithms as a part of the intellectual property. Contrary to this trend, the general customer availability of LoRaWANTM products catalyzed the creation of several open source NM implementation projects which include the globally recognized The Things Network (TTN) and a younger LoRa Server whose ADR algorithms are publicly available [thethingsnetwork.org/wiki/LoRaWAN/ADR]. In this paper, their algorithm was adapted and further improved as part of the effort to support the community project.~~\citet{bor_lora_2016} propose an algorithm to select parameters such that transmission airtime and power are minimized. However, the authors themselves described the proposed algorithm as optimistic and impractical; their goal was to show that improvements in network capacity are possible with dynamic data rates. In contrast, we evaluate the ADR mechanism built into LoRaWAN and suggest a simple yet effective modification to improve its performance.~\citet{bor_lora_2016} experimentally observed the capture effect of LoRa and modeled the capacity of such networks, concluding that LoRa networks with one gateway and conservative operational parameters do not scale well, while networks with dynamic adaptation of operating parameters or multiple gateways scale better.~Authors in \cite{bor_lora_2016} implemented and used the LoRaSim simulator [www.lancaster.ac.uk/scc/sites/lora] to investigate the capacity limits of LoRa networks. They showed that a typical deployment can support only 120 nodes per 3.8 ha, although performance can be improved with multiple gateways.~In \cite{bor_lora_2016} the Authors estimated, through simulations, the capacity of a LoRa network assuming a simpler collision mechanism and protocol than what we used in this work; these assumptions lead to a lower capacity with respect to what we present in this paper.~In \cite{bor_lora_nodate}, the authors present a performance and capability analysis of a currently available LoRa transceiver. They describe the tranceiver's features and demonstrate how it can be used efficiently in a wide-area application scenario. In particular, they demonstrate how unique features such as concurrent non-destructive transmissions and carrier detection can be employed. The experiments demonstrate that six LoRa nodes can form a network covering 1:5:ha in a built up environment, achieving a potential lifetime of 2 year on 2 AA batteries, delivering data within 5 s with reliability of 80\textbackslash\%.~~~   \newline 
 \cite{erbati_analysis_2018}   \citet{erbati_analysis_2018} analyzed LoRa performance in an outdoor environment in Duisburg, Germany. A LoRaWAN gateway was installed in an eight-story building located in the city of Duisburg. Experiments were conducted in a non-LOS real-world environment where there exist various obstacles, such as buildings, cars, and trees. The distance varied from 300 m to 1850 m, and 500 data were sentfrom each spot. The following parameter settings were used: 21 bytes of payload, a CR of 4/5, SF 10, and 125 kHz bandwidth. Results show that the Received Signal Strength Indication (RSSI) value decreases logarithmically with increasing distance. A data packet is not decoded anymore when the distance becomes greater than 1,850 m, where a PDR of 69\textbackslash\% is achieved.~   \newline 
 \cite{gupta_modelling_2017}   \citet{gupta_modelling_2017} modeled the IoT traffic considering periodic messages and event-generated messages and analyzed the impact of traffic variations in LoRa WAN networks. They were able to identify that LoRa gateways do not handle well burst events, which generate a significant amount of messages in a short period, especially when there is a spatial or temporal correlation in the transmission behavior of IoT devices.~   \newline 
 \cite{kim_secure_2018}   \citet{kim_secure_2018} propose a secure device-to-device link establishment scheme to guarantee security features in LoRaWAN and evaluated the performance by comparing the energy consumption.~   \newline 
 \cite{liao_multi-hop_2017}   \citet{liao_multi-hop_2017} analyze the effect of the simultaneous LoRa transmissions over the performance level. The paper proposes the integration of a CT (Concurrent Transmission) type flooding into the technology. CT is an extremely efficient flooding type protocol that has recently revolutionized the design of the multihop networks based on the IEEE-802.15.4 standard. Instead of attempting to avoid packet collision, CT enables more nodes to send packets with the same content simultaneously, at the same time moment. By allowing such synchronized packets collisions, CT enables rapid backto-back relaying of packets that considerably improve the efficiency of the network. The paper proposes the implementation of such a strategy for increasing the performance level of the LoRa networks by introducing a multihop mechanism. None of the papers evaluate the maximum number of nodes that can communicate on a channel, taking into consideration a real implementation scenario.~   \newline 
 \cite{neumann_indoor_2016}   \citet{neumann_indoor_2016} deployed both the gateway and nodes inside to study LoRa performance in an indoor environment. In the experiments, the distances between nodes and the gateway were 0.50 {$\sim$} 60 m. The result shows that RSSI decreases rapidly on a log scale with increasing distance compared with the outdoor environment, but it is reliable enough to be used indoors. However, when the distance becomes very small, packet errors occur frequently as a result of a bad cyclic redundancy check (CRC).~Many other studies provide the power consumption of sensor nodes based on LoRa/LoRaWAN. Most of the current values were obtained from the datasheet or by empirical means \cite{neumann_indoor_2016}[Design and implementation of the plug-play enabled flexible modular wireless sensor and actuator network platform]LoRa Mobile-To-Base-Station Channel Characterization in the Antarctic], without developing an energy model that can estimate and optimize the energy consumption of the wireless sensors.~   \newline 
 \cite{petajajarvi_evaluation_2017}   \citet{petajajarvi_evaluation_2017} also tested the usage of LoRa in indoor environments. The results show that very low packet-loss is to be expected with only one base-station to cover an average university campus.   \newline 
 \cite{petajajarvi_performance_2017}   \citet{petajajarvi_performance_2017} analyzed the capacity of a LoRaWAN cell. For applications requiring transmission of only a single packet per day, the cell may serve up to millions of devices. However, in case of applications reporting messages every minute, only few hundreds of devices may be hosted.\% ----------------------------------------------------- \citet{petajajarvi_performance_2017} also evaluated the performance of the LoRa communication under the presence of the doppler shift. The results concluded that with SF = 12 (which enables the longest range) the communication deteriorates when relative speed exceeds 40 km/h whereas with a lower mobility it can be assured a reliable communication; finally, it was also evaluated the coverage attained by a LoRa device transmitting with SF = 12 and a transmission power of 14 dBm; as a result, it was determined the feasibility of communicating within a distance of 2 - 5 km, and in a range of 15 - 30 km on the water.~In \cite{petajajarvi_performance_2017}, the Doppler effect over the LoRa modulation is analyzed, by performing a series of experimental measurements. From the obtained results, the authors conclude that, by using SF=12, a communication range of up to 30 km with a packet loss of 62 \textbackslash\% can be obtained.~\citet{petajajarvi_performance_2017} analyze Doppler robustness, scalability, and coverage of LoRa networks and report the experimental validation of such metrics in terrestrial and water environments for static and mobile nodes.~\citet{petajajarvi_performance_2017} analyzed the scalability of a LoRa wide area network and showed its good coverage (e.g. until 30km on water for SF12 and transmit power of 14 dBm). They also showed the maximum throughput for different duty cycles per node per channel.~   \newline 
 \cite{qin_resource_2017}   \citet{qin_resource_2017} approach the optimization of LPWANs efficiency from a resource allocation perspective. They use game theory to derive an algorithm that allows network nodes to decide which channel and SF to use and, for each channel/SF group, which is the optimal transmit power that maximizes data extraction rate.~   \newline 
 \cite{song_internet_2017}   \citet{song_internet_2017} propose a IoT solution in energy management system based on the LPWAN technology.\citet{song_internet_2017}\cite{tzounis_internet_2017} discuss the IoT solutions towards the modernization of agriculture and present a survey of IoT technologies in the agricultural sector.   \newline 
 \cite{wixted_evaluation_2016}   \citet{wixted_evaluation_2016} evaluated the LoRa coverage in the Central Business District in Glasgow, Scotland. A LoRa gateway was installed on the roof of the 7th floor of a university building. Carrying nodes with SF 12 in a backpack, a tester moved around the city and measured the received signal strength. The experimental result shows that it is possible to successfully receive packets 2.2 km in the south direction and 1.6 km in the north direction (before passing through the hill). The authors mentioned that the east and west directions were not fully tested but were measured to about 2 km.~In \cite{wixted_evaluation_2016} the Authors studied experimentally the impact on the coverage of having multiple gateways deployed in a particular area of Glasgow. Our work, though, focuses more on capacity than on coverage: a fact of relevance for LoRa, whose receive sensitivity depends on transmission parameters (the Data Rate).   \newline 
 \cite{finnegan_comparative_2018}   Comment: 10 pages   \newline 
 \cite{jang_swapped_2016}   Data Compression: The authors in \cite{jang_swapped_2016} were interested in data compression in order to reduce the size of the data sent and thus minimize the transmission time and optimize the energy consumption. A swapped huffman tree coding has been applied to transmit the necessary data with a compression ratio of 52.3\textbackslash\%. Data compression has been used in various LoRa sensors in the industry \cite{LorawanSpecification} in order to reduce energy consumption and thus reduce the data transmission time that will provide better optimization of the LoRa network. The two studies mentioned above were interested in optimizing energy consumption without worrying about the regulatory constraints relating to the channel occupancy time.   \newline 
 \cite{mikhaylov_lorawan_2017}   Empirical evaluations have been also provided in \cite{mikhaylov_lorawan_2017}.~Finally, the work most closely related to ours is \cite{mikhaylov_lorawan_2017}, an empirical study of interference between LoRa networks (a pre-print at the time of this writing). The paper investigates the interference case when one LoRa radio uses conventional LoRa modulation and the other one uses 2-GFSK modulation, which is also used in IEEE 802.15.4g. (Support for 2-GFSK is required in the LoRa specification.) The experiments use randomized packet lengths and inter-arrival times for both the sender and the interferer. The inter-arrival times are a significant fraction of (and in some cases longer than) the packet transmission times. This means that the proportion of time that the channel is interfered varies depending on the choice of LoRa transmission parameters. As a consequence, the results reflect a mix of heavily and minimally interfered packets. It is therefore hard to draw conclusions about the interference behavior, beyond the specific empirical observations. By contrast, we are doing much more controlled experiments that allow us to examine the interaction between the two modulations in detail.   \newline 
 \cite{conus_event-driven_2016}   In \cite{conus_event-driven_2016}, the battery capacity consumed during a day by a device is calculated assuming 100 events detected and 10 frame transmissions performed by the device. The result is 222.66 {$\mu$}Ah, which corresponds to a lifetime of 21.5 months for a 150 mAh button cell battery. Neither the impact of using acknowledgments, nor the influence of the DR configured are considered. Finally, the impact of errors due to corruption on LoRaWAN energy performance has not been modeled in publicly available works.~   \newline 
 \cite{kim_cooperative_2017}   In \cite{kim_cooperative_2017}, which focuses only on optimizing downlink communications, fixed LoRaWAN settings (i.e., a single DR and acknowledged transmission) are considered. Energy consumption of 0.05\textendash{}0.44 mJ and a battery lifetime between 13 and 1 year, respectively, are obtained for a device running on two AA batteries, when transferring data from 1 to 10 times per hour. However, one of the most important values used in the model, the sleep current (of 2 {$\mu$}A), is without explanation significantly lower than the corresponding value in the datasheet published by the manufacturer (i.e., 30.9 {$\mu$}A).~   \newline 
 \cite{naoui_enhancing_2016}   In \cite{naoui_enhancing_2016}, authors presented a solution to improve the overall security of a LoRaWAN-based IoT system. This proposal employed proxy-nodes for performing the cryptographic operations in order to avoid heavy computation in the constrained end-nodes.   \newline 
 \cite{vangelista_frequency_2017}   In \cite{vangelista_frequency_2017} the mathematic model of the LoRa modulation and also of the demodulation process based on signal processing theory is presented. The paper also presents a comparison of the performance levels between the LoRa modulation and the FSK (Frequency-Shift Keying) modulation, regarding the value of the encoded bit error rate parameter. The obtained results show that when an AWGN (Additive White Gaussian Noise) channel is used, the LoRa modulation ensures a higher performance level.~   \newline 
 \cite{voigt_mitigating_2016}   In \cite{voigt_mitigating_2016}, simulation is used to show that multiple base stations improves the network performance under interference.\citet{voigt_mitigating_2016} investigate the use of directional antennae and the use of multiple base stations as methods of dealing with internetwork interference. Simulation results show that the use of multiple base stations outperforms the use of directional antennae.~\citet{voigt_mitigating_2016} consider the inter-network interference that is likely to take place when several independent LoRa networks get deployed too close. Authors consider using directional antennas in network nodes and using multiple gateways in the network. Results show that directional antennas enhance data extraction rate, although the use of multiple gateways in the covered area tends to perform better. Besides the above works, some authors have explored techniques similar to those proposed in this paper for LoRa , UNB/S IG F OX , or for LPWANs in general.   \newline 
 \cite{weber_ipv6_2016}   In turn, work in \cite{weber_ipv6_2016} presented an integration of IPv6 into LoRaWAN. Similar to the case of 6LoWPAN, this solution permitted a higher interoperability of the IoT network with the outside world. Although interesting, both works lacked of a detailed performance evaluation to demonstrate the impact of their proposals on the system operation. From a different perspective, other studies presented the results extracted from experimental tests conducted in diverse scenarios and situations [next citation]. These works focused on evaluating the performance of LoRaWAN under different propagation and environmental conditions.~   \newline 
 \cite{ke_lora_2017}   Moreover, it was shown \cite{ke_lora_2017} that constructing a mesh LoRa network is a good solution to solve the coverage problem in extensively shadowed urban areas. However, few reports that discuss the SF allocation in a mesh LoRa network have been published. On the other hand, similar to SF allocation in a mesh LoRa network, the adoption of parallel transmission by using multiple channels has already been implemented in conventional multi-hop single-root data collection networks.~   \newline 
 \cite{afonso_design_2019}    \newline 
 \cite{angrisani_lora_2017}    \newline 
 \cite{aref_free_2014}    \newline 
 \cite{delobel_analysis_2017}    \newline 
 \cite{dongare_openchirp_2017}    \newline 
 \cite{erturk_survey_2019}    \newline 
 \cite{haxhibeqiri_survey_2018}    \newline 
 \cite{li_application_2017}    \newline 
 \cite{magno_wulora_2017}    \newline 
 \cite{mahmood_scalability_2019}    \newline 
 \cite{martinez_performance_2019}    \newline 
 \cite{navarro-ortiz_integration_2018}    \newline 
 \cite{nolan_evaluation_2016}    \newline 
 \cite{noreen_study_2017}    \newline 
 \cite{oliveira_long_2017}    \newline 
 \cite{ozyilmaz_designing_2019}    \newline 
 \cite{radcliffe_usability_2017}    \newline 
 \cite{rizzi_evaluation_2017}    \newline 
 \cite{san-um_long-range_2017}    \newline 
 \cite{sartori_enabling_2017}    \newline 
 \cite{stan_overview_2016}    \newline 
 \cite{venkatesan_design_2017}    \newline 
 \cite{wang_performance_2017}    \newline 
 \cite{barro_smart_2019}   Noted that \cite{barro_tltn_2019} and \cite{barro_smart_2019} are steps of \cite{barro_towards_2018} that aims to study the feasibility of the smart city in developing countries, especially in Africa. However, saying that Internet is not accessible or is intermittent is only a general observation, so some people can claim to have acceptable connectivity \cite{barro_smart_2019} (with a round-trip time less than 100 ms (see Fig.1)) and therefore, will want to go in this direction. This is why it should be wise and judicious to propose an architectural model offering several options of communication on demand and which will remain flexible to future evolutions.   \newline 
lora-power \cite{sartori_smart_2016}    \newline 
 \cite{tunc_markov_2017}    \newline 
 \cite{zurita_ares_power_2007}    \newline 
lora-z \cite{petric_measurements_2016}   A few papers, such as \cite{petric_measurements_2016}, present measurements of existing LoRa systems and study the actual performance of the end devices with respect to their relative distance to the gateways. They aim at optimising the parametrization of LoRa networks. However, due to the limited number of end devices considered in these studies, it is difficult to gauge the scaling properties of LoRa networks, for instance in terms of the maximum number of end devices supported with a given goodput rate. Moreover, these studies do not permit a fine-tuned analysis of collisions in LoRa networks.~For example, in \cite{petric_measurements_2016-1}, a real LoRaWAN deployment was evaluated and it was found that the base-station antenna location and elevation have great importance in the network performance. The measurements were carried out using three different base-stations. A similar experimental study was elaborated in A Study of LoRa: Long Range \textbackslash\& Low Power Networks for the Internet of Things. In this case, authors focused on tuning the LoRaWAN PHY layer, i.e., LoRa, configuration parameters, identifying both Spreading Factor (SF), which will be explained later in detail, and data-rate as the principal factors impacting on the network coverage.~\citet{petric_measurements_2016} deployed a LoRa experiment using an Arduino module and a Froggy Factory LoRa shield in the city of Rennes with their key focus on the quality of service. They measured traffic between the gateway and the end devices. The traffic generated was like that of a sensor monitoring network. They focused on an observation of the performance metrics, not on overall LoRa design and deployment.   \newline 
 \cite{capuzzo_mathematical_2018}   A step further is made in \cite{capuzzo_mathematical_2018} where the authors develop a model that makes it possible to consider various parameters configurations, such as the number of ACKs sent by the GW, the SF used for the downlink transmissions, and the DC constraints imposed by the regulations. In this work, however, multiple retransmissions have not been considered.~   \newline 
 \cite{croce_impact_2018}   \citet{croce_impact_2018} showed the effect of the quasi-orthogonality of SFs and found that overlapped packet transmissions with different SFs may suffer from losses. They validated the findings by experiments and proposed SIR thresholds for all combinations of SFs. They remarked that LoRa networks cannot be studied as a superposition of independent networks because of imperfect SF orthogonality.~   \newline 
 \cite{goursaud_dedicated_2015}   \citet{goursaud_dedicated_2015} studied the performance of the CSS modulation. They showed the possibility of interference between different SFs and evaluated co-channel rejection for all combinations of SFs.~   \newline 
 \cite{marco_cattani_experimental_2017}   \citet{marco_cattani_experimental_2017} evaluated the impact of the LoRa physical layer settings on the data rate and energy efficiency. They evaluated the impact of environmental factors such as temperature on the LoRa network performance and showed that high temperatures degrade the Packet Delivery Ratio (PDR) and Received Signal Strength (RSS).   \newline 
 \cite{raza_low_2017}   \citet{raza_low_2017} present the five key challenges for LPWAN and compare proprietary and standard technologies, including LoRa, Sigfox, 802.15.4g or Dash7 to cite a few. These challenges are ultra low-power operation and long range communication, since it is expected to cover wide areas for several years. To this aim, 1-hop networks and duty cycling are employed. Low cost is also another challenge for LPWAN. Finally, scalability and quality of service are also challenges given the expected number of connected objects, and the variety of expected services.   \newline 
 \cite{reynders_range_2016}   \citet{reynders_range_2016} evaluated Chirp Spread Spectrum (CSS) and ultra-narrow-band networks. They proposed a heuristic equation that gives Bit Error Rate (BER) for a CSS modulation as a function of SF and Signal to Noise Ratio (SNR).~In \cite{reynders_range_2016}, the performances in terms of packet delivery ratio and throughput of LoRaWAN Rand Sigfox R are simulated. However, the simulation process and the numerous network parameters are not exposed enough thus lacking of transparency and possibility of reuse.~\citet{reynders_range_2016} compared the performance of LoRa and Ultra Narrowband (UNB, SIGFOX-like) networks with regard to the range and coexistence. They showed that UNB MAC is slightly better than LoRaWAN: the latter discards both colliding packets at reception, while the UNB network enables reception of the strongest packet thanks to the capture effect. The maximal throughput of the network occurs for 10 5 devices in the network, but results in a packet loss of 63\textbackslash\%.~The paper in \cite{reynders_range_2016} compared the performance of LoRa and ultra narrowband (Sigfox-like) networks, showing that ultra narrowband has a larger coverage but LoRa networks are less sensitive to interference. Finally, authors in [Decoding LoRa: realizing a modern LPWAN with SDR] presented details on the patented LoRa PHY and introduced gr-lora, an open source SDR-based implementation of LoRa PHY. All of these works, however, assume that the SFs adopted by LoRa are perfectly orthogonal, thus simplifying the analysis and consequently the network capacity. Instead, in this paper we show that, due to the imperfect orthogonality of the SFs, inter-SF collisions can prevent the correct reception of the transmissions with serious impact on LoRa performances. To the best of our knowledge, we are the first to demonstrate and quantify this performance degradation.~   \newline 
 \cite{sanchez-iborra_performance_2018}   \citet{sanchez-iborra_performance_2018} evaluate the performance of LoRaWAN on different real scenarios. Also the energy consumption is considered by some researchers.   \newline 
 \cite{jetmir_haxhibeqiri_lora_2017}   In a system level simulator, \citet{jetmir_haxhibeqiri_lora_2017} studied the scalability for LoRaWAN deployments in terms of the number of nodes per gateway. Simulations are performed for a duty cycle of 1\textbackslash\% but they are limited to 1000 nodes. We developed a LoRa simulator to compare the performance in different deployment scenarios for large scale networks based on an accurate model of the LoRa PHY/MAC layers. We simulate several deployment scenarios varying traffic intensity and the number of nodes. C. LoRa Evaluation and Limits Several authors evaluated performance and limits of LoRa networks.~\citet{jetmir_haxhibeqiri_lora_2017} investigated the scalability of LoRa in terms of the number of devices per gateway. They used a simulation model based on the measurements of the interference behavior between two nodes to show that when the number of nodes with the duty cycle of 1\textbackslash\% increases to 1000 per gateway, losses increase to 32\textbackslash\%. However, this level of the loss rate should be considered as low compared to 90\textbackslash\% in pure ALOHA for the same load and it results from taking into account the capture effect, which apparently plays an important role in the LoRa behavior. We compare their measured packet loss rate and collision ratio with the simulation results.~In contrast, \cite{jetmir_haxhibeqiri_lora_2017} scrutinizes interference in LoRa in order to establish packet collision rules, which are reproduced next in a simulation model allowing the authors to study the scalability issues of LoRa networks.   \newline 
 \cite{ferre_collision_2017}   In \cite{ferre_collision_2017} the author proposes closed-form expressions for collision and packet loss probabilities and, under the assumption of perfect orthogonality between SFs, it is shown that the Poisson distributed process does not accurately model packet collisions in LoRaWAN.~   \newline 
 \cite{kouvelas_employing_2018}   In \cite{kouvelas_employing_2018} it is shown how the use of a persistent-Carrier Sense Multiple Access (p-CSMA) MAC protocol when transmitting UL messages can improve the packet reception ratio. However, attention must be payed to the fact that having many EDs that defer their transmission because of a low value of p may lead to channel under-utilization.~   \newline 
 \cite{aden_hassan_evaluating_2019}    \newline 
 \cite{alami_memory_nodate}    \newline 
 \cite{al-kashoash_comparison_2016}    \newline 
 \cite{ayoub_internet_2019}    \newline 
 \cite{bembe_survey_2019}    \newline 
 \cite{boano_impact_2018}    \newline 
 \cite{chen_efficient_2019}    \newline 
 \cite{durrani_survey_2019}    \newline 
 \cite{eriksson_investigating_2017}    \newline 
 \cite{haghighi_game_2016}    \newline 
 \cite{huang_lora-based_2018}    \newline 
 \cite{irio_modeling_2019}    \newline 
 \cite{jebril_overcoming_2018}    \newline 
 \cite{lee_monitoring_2018}    \newline 
 \cite{lundell_routing_2018}    \newline 
 \cite{mekki_comparative_2019}    \newline 
 \cite{paredes-parra_alternative_2019}    \newline 
 \cite{pasolini_smart_2018}    \newline 
 \cite{piyare_-demand_2018}    \newline 
 \cite{reynders_chirp_2016}    \newline 
 \cite{robyns_*physical-layer_2017}    \newline 
 \cite{sinha_survey_2017}    \newline 
 \cite{toldov_adaptive_nodate}    \newline 
 \cite{mikhaylov_analysis_2016}   The paper \cite{mikhaylov_analysis_2016} analyses the performance of the LoRa LPWAN technology by showing that, in accordance to the specifications, a single end device located close to the base station can feature an uplink data transfer channel of only 2 kbit/s at best. In terms of scalability, they show that a single LoRaWAN cell can potentially serve several millions of devices sending few bytes of data per day. Nonetheless, they showed that only a small portion of these devices can be located sufficiently far away from the base station.~\citet{mikhaylov_analysis_2016} discussed LoRa performance under European frequency regulations. They studied the performance metrics of a single end device, then the spatial distribution of several end devices. They showed LoRa strengths (large coverage and good scalability for low uplink traffic) and weaknesses (low reliability, delays, and poor performance of downlink traffic).~In one of the first works on this topic, \citet{mikhaylov_analysis_2016} present an analysis of the capacity and scalability of LoRa LPWANs. The authors perform an analytical analysis of the maximum throughput for a single LoRaWAN end device, taking into account such factors as RDC and the influence of receive windows. The authors note that receive windows drastically increase the time between subsequent transmissions and that RDC restrictions reduce the maximum throughput further. The authors applied the same methodology to determine the capacity of LoRaWAN based on ALOHA access. While it is true that the LoRaWAN MAC access is an ALOHA scheme, empirical data has shown that the assumptions made in pure ALOHA access do not adequately model a LoRaWAN network (see figure 4 in \cite{bor_lora_2016}). Specifically, it fails to model the interference between concurrent transmissions as pure ALOHA assumes concurrent transmissions are always lost regardless of their received power levels, timings and the presence of forward error correction.~\citet{mikhaylov_analysis_2016} analyzed and assessed the throughput of the LoRa technology, determining the airtime of a packet. Therefore, it is possible to estimate the maximum number of nodes that can communicate with a Gateway module. The purpose of this paper was to analyze the ALOHA communication mechanism. The results are obtained at an empirical level.~\citet{mikhaylov_analysis_2016} showed that a LoRa cell can potentially serve a large number of devices, but devices are limited to sending only a few bytes of data per day. The majority of devices need to be located in the vicinity of the gateway: only less than 10\textbackslash\% can reside at distances longer than 5 km. Another factor that limits scalability is the use of acknowledgements\textemdash{}as the gateway is subject to the same ETSI restrictions on the duty cycle, it cannot acknowledge each packet in a dense network.~In \cite{mikhaylov_analysis_2016}, multiple annuli LoRaWAN R cell structure is well modelled and illustrated with a few applicative scenarios. This structure is considered in our article but channel effects and capture effect are added to our model thus making it more complete and realistic.   \newline 
 \cite{augustin_study_2016}   The work in \cite{augustin_study_2016} provides an overview of LoRa and an indepth analysis of its functional components. The physical and data link layer performance are evaluated by field tests and simulations. Based on the analysis and evaluations, the authors show that LoRa physical layer, thanks to the chirp spread spectrum modulation and high receiver sensitivity, offers good resistance to interference. Field tests show that LoRa can offer satisfactory network coverage up to 3 km in a suburban area with dense residential dwellings. The SF has significant impact on the network coverage, as does the data rate.~A second, but similarly lacking, pure ALOHA capacity analysis of LoRaWAN is discussed in \cite{augustin_study_2016}.~\citet{augustin_study_2016} reported the result of suburban experiments in Paris. Cisco 910 as a gateway was installed outside a residential window at a height of about 5 meters. LoRa nodes were placed in 5 different locations so that their distances from the gateway were 600 m, 1400 m, 2300 m, 2800 m, and 3400 m. There were 3 options for SF values: 7, 9, and 12. The adaptive data rate and retransmission were not used. Experimental results show that the PDR is about 90\textbackslash\% when SF 12 is used at 2800 m, and the ratio drops to less than 10\textbackslash\% at SF 9. At 3400 m, only about 40\textbackslash\% of the received packets have SF 12.\citet{augustin_study_2016} presented throughput measurements on a testbed showing: i) less than 10\textbackslash\% of loss rate over a distance of 2 km for SF 9-12 and ii) more than 60\textbackslash\% of loss rate over 3.4 km for SF 12. They also simulated the LoRa behavior for a larger number of devices and showed that it behaves closely to ALOHA with the maximum channel capacity of 18\textbackslash\% and an increasing collision ratio: for a link load of 0.48, the ratio is around 60\textbackslash\%.~As mentioned by \citet{augustin_study_2016}, the packet payload is up to 255 bytes with a low duty cycle limit. Their study led to a number of open research challenges, particularly in channel management, such as time division multiple access over LoRaWAN and random-based access in unlicensed bands. To design and improve LoRa network performance, understanding network-related dependencies is essential.~\citet{augustin_study_2016} also studied network-related parameters for performance improvements and also measured network sensitivity and coverage. Our study proposed an appropriate strategy on gateway placement based on signal intensity and sensitivity in the context of three building density environments in Brisbane, Australia.~   \newline 
